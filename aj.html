<html>
<head>
	<title>AJ</title>
	<meta http-equiv="content-type" content="text/html;charset=utf-8">
	<link rel="stylesheet" type="text/css" href="lib/bootstrap-3.3.5-dist/css/bootstrap.min.css" />
	<link rel="stylesheet" href="css/common.css">
	<link href="http://vjs.zencdn.net/5.0.0/video-js.css" rel="stylesheet">
</head>
<body>
	<div class="v-bar">
		<div class="v-bar-memu">
			<ul class="v-bar-list">
				<li title="login"><span class="glyphicon glyphicon-user"></span></li>
				<li title="focus"><span class="glyphicon glyphicon-star"></span></li>
				<li title="message" id="vMessage"><span class="glyphicon glyphicon-envelope"></span></li>
			</ul>
		</div>

		<div class="v-bm" id="vMessageBar">
			<div class="v-bm-wrap">
				<h2>Message</h2>
				<p>This is a message1</p>
				<p>This is a message2</p>
				<p>This is a message3</p>
			</div>
		</div>

	</div>

	<div class="container v-main">
		<div class="row">

			<div class="col-lg-6">
				<video id="my-video" class="video-js" controls preload="auto" width="550px"
				poster="image/oceans-clip.png" data-setup="{}">
					<source src="image/oceans-clip.mp4" type='video/mp4'>
					<p class="vjs-no-js">
					To view this video please enable JavaScript, and consider upgrading to a web browser that
					<a href="http://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a>
					</p>
				</video>
			</div>
			
			<div class="col-lg-4">
				<div class="panel panel-primary">
					<div class="panel-heading">
						<ul class="nav nav-tabs" role="tablist">
							<li role="presentation" class="active"><a href="#">Home</a></li>
							<li role="presentation"><a href="#">Profile</a></li>
							<li role="presentation"><a href="#">Messages</a></li>
						</ul>
					</div>
					<div class="panel-body">
						<div >
                            <p>w1Âú®Á∫ø‰∫∫Êï∞<span id="userNum1"></span></p>
                            <div id="message1"></div>
						</div>
						<div class="input-group">

							<input type="text" id="input1" class="form-control" aria-label="Amount (to the nearest dollar)">
							<span class="btn input-group-addon" id="sub1">ÂèëÈÄÅ</span>
							<span class="btn input-group-addon">üòÑ</span>
						</div>
					</div>
				</div>
			</div>

			<div class="col-lg-2">
				<div class="panel panel-primary">
				  <!-- Default panel contents -->
				  <div class="panel-heading">Notice</div>
				  <div class="panel-body">
				    <p>Some default panel content here. Nulla vitae elit libero, a pharetra augue. Aenean lacinia bibendum nulla sed consectetur.</p>
				  </div>
				</div>
				<div class="panel panel-primary">
				      <!-- Default panel contents -->
				      <div class="panel-heading">Ranking</div>

				      <!-- Table -->
				      <table class="table">
				        <thead>
				          <tr>
				            <th>First Name</th>
				            <th>Last Name</th>
				          </tr>
				        </thead>
				        <tbody>
				          <tr>
				            <td>Mark</td>
				            <td>Otto</td>
				          </tr>
				          <tr>
				            <td>Jacob</td>
				            <td>Thornton</td>
				          </tr>
				          <tr>
				            <td>Larry</td>
				            <td>the Bird</td>
				          </tr>
				        </tbody>
				      </table>
				</div>
			</div>
		</div>
	</div>
	
	<div id="react-demo"></div>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.0/react.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.0/react-dom.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js"></script>
	
	<script type="text/javascript" src="lib/jquery-1.11.3.min.js"></script>
	
	<script type="text/babel">
		ReactDOM.render(
			<div>Reactjs-demo, Hello, world!</div>,
			document.getElementById('react-demo')
		);
	</script>
	<script type="text/javascript">
		$(function(){
			$("#vMessage").on("click", function(){
				$("#vMessageBar").toggleClass("active");
			});
			
		});
	</script>

    <script type="text/javascript">
        (function(){
            var $ = function(id){return document.getElementById(id) || null;}

            var wsServer = 'ws://127.0.0.1:8080';
            var ws = new WebSocket(wsServer);
            var isConnect = false;
            ws.onopen = function (evt) {
                console.log("ws1 ÈìæÊé•ÊàêÂäü");
                isConnect = true;
            };
            ws.onclose = function (evt) {
                console.log("Disconnected");
            };
            ws.onmessage = function (evt) {
                var data = JSON.parse(evt.data);
                switch (data.type) {
                    case 'text':
                        addMsg(data.msg);
                        break;
                    case 'num' :
                        updataUserNum(data.msg);
                        break;
                }

                console.log('Retrieved data from server1: ' + evt.data);
            };
            ws.onerror = function (evt) {
                console.log('Error occured: ' + evt.data);
            };




            function sendMsg() {
                if(isConnect){
                    ws.send($('input1').value);
                    $('input1').value = '';
                }
            }
            function addMsg(msg) {
                msg = JSON.parse(msg);
                var text = 'Áî®Êà∑' + msg.user + 'ËØ¥Ôºö' + msg.text + '\n';
                $('message1').innerText += text;
                $('message1').scrollTop = $('message1').scrollHeight;
            }
            function updataUserNum(msg) {
                $('userNum1').innerText = msg;
            }
            $('sub1').addEventListener('click',sendMsg,false);

        })();
    </script>
	<script src="http://vjs.zencdn.net/5.0.0/video.js"></script>
	
</body>
</html>